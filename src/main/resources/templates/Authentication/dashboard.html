<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Dashboard</title>
</head>
<body>
	<h2>Welcome, <span th:text="${user.name}"></span>!</h2>
	<p>Your UPI ID: <span th:text="${user.upiId}"></span></p>
	<p>Your Mobile: <span th:text="${user.mobile}"></span></p>
	
	<!-- Show bank message if no bank linked -->
	<p th:if="${bankMessage != null}" th:text="${bankMessage}"></p>
	
	
	<!-- Error message -->
	<div th:if="${error}" class="alert alert-danger">
	    <p th:text="${error}"></p>
	</div>
	
	<!-- Show warning if no primary account is set -->
	<p th:if="${hasPrimaryBankAccount == false}">
		User does not have any Primary Account. For further process, please select a Primary Account.
	</p>
	
	
	
	
	
	<!-- Show list of bank accounts if available -->
	<div th:if="${bankList != null}">
	    <h3>Your Bank Accounts:</h3>
	    <ul>
	        <li th:each="bank : ${bankList}">
	            <span th:text="${bank.bankName}"></span> -
	            <span th:text="${bank.accountNumber}"></span>

	            
				<!-- Show (Primary) if this is the primary account -->
                <span th:if="${bank.primaryAccount}" style="color:green; font-weight:bold;">
                    (Primary)
                </span>
				
				<!--This button redirects the user to /bank/process with the account ID attached, 
				so the server knows which bank account to operate on.-->
				
				<!--   URL    :   http://localhost:8080/bank/process?accountId=1    -->
				
				<!-- Operate button -->
				<span th:if="${hasPrimaryBankAccount == true}">
		            <form th:action="@{/bank/process}" method="get">
		                <input type="hidden" name="accountId" th:value="${bank.accountNumber}" />
		                <button type="submit">Operate</button>
		            </form>
				</span>
				
				<!-- Set as Primary button (only show if not already primary) -->
                <form th:if="${!bank.primaryAccount}" th:action="@{/bank/set-primary}" method="post">
                    <input type="hidden" name="accountId" th:value="${bank.accountNumber}" />
                    <button type="submit">Set as Primary</button>
                </form>
				
	        </li>
	    </ul>
	</div>
	
	<!-- Add Bank button (always visible) -->
	<form th:action="@{/add-bank}" method="get" style="margin-top: 15px;">
	    <button type="submit">Add Bank</button>
	</form>
	
	
	
	<a th:href="@{/transactions}">Show all transactions</a>
	
	<!-- Logout -->
	<a href="/login">Logout</a>
</body>
</html>
